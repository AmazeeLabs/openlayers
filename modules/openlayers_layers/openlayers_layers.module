<?php
// $Id$

/**
 * @file
 * This file holds the main Drupal hook functions 
 * and private functions for the openlayers_layers module.
 */

/**
 * Implementation of hook_help
 */
function openlayers_layers_help($path, $arg) {
  switch ($path) {
    case 'admin/help#openlayers_layers':
      $output = '<p>'. t('Provides CCK fields and widgets through an OpenLayers interface.') .'</p>';
  }
  
  return $output;
}

/**
 * Implementation of hook_openlayers_layers_info
 */
function openlayers_layers_openlayers_layers_info() {
  $file = drupal_get_path('module', 'openlayers_layers') .'/includes/openlayers_layers.layers.inc';
  $callback = 'openlayers_layers_process_layers';
  $info = array();
  
  // Define info array
  $info['openlayers_layers_nasa_global_mosaic'] = array(
    'name' => t('NASA Global Mosaic'),
    'file' => $file,
    'callback' => $callback,
  );
  $info['openlayers_layers_open_aerial'] = array(
    'name' => t('Open Aerial (2.8+) (do not use)'),
    'file' => $file,
    'callback' => $callback,
  );
  
  return $info;
}

/**
 * Implementation of hook_openlayers_layers_handler
 */
function openlayers_layers_openlayers_layers_handler(&$layers = array(), $map = array()) {
  $layers_return = (is_array($layers)) ? $layers : array();

  // Add Layers JS
  drupal_add_js(drupal_get_path('module', 'openlayers_layers') .'/js/openlayers_layers_layers.js', 'module');
  
  // Go through array and add handler
  foreach ($layers as $k => $layer) {
    // switch by type
    switch ($layer['type']) {
      case 'XYZ':
        $layers_return[$k]['layer_handler'] = 'openlayersLayerHandlerXYZ';
        break;
        
      default:
        break;
    }
  }
  
  return $layers_return;
}